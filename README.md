# Domino MLflow Models

This project contains examples of various MLflow supported models such as XGBoost, Sklearn, PyTorch, TensorFlow, and custom Pyfunc models. These include code snippets to register the model to MLflow, register training sets to Domino, and configuring prediction data capture.

The assets included in the project are:

* **domino-mlflow-model-sklearn-imm.ipynb** - a notebook that trains a sklearn linear regression model on the California Housing Prices dataset and does the following:

    * Registers the training data used as a training set
    * Creates a pyfunc model wrapper class that configures a model with prediction data capture to capture the numerical prediction responses
    * Register the linear regression model in MLflow

* **domino-mlflow-model-xgboost-imm.ipynb** - a notebook that trains a xgboost classifier model on the Iris dataset and does the following:

    * Registers the training data used as a training set
    * Creates a pyfunc model wrapper class that configures a model with prediction data capture to capture the categorical prediction responses
    * Register the classifier model in MLflow
    
* **domino-mlflow-model.ipynb** - a notebook that has examples of how to register the following mlflow supported models using a pyfunc model wrapper class:
    
    * Sklearn model with column based inputs 
    * XGBoost, PyTorch, TensorFlow and custom Pyfunc models with tensor based inputs
  
  See examples of Model API inputs below for each of these models. 

## Model API

You can test the Model API using the following observation:

### Sklearn - Housing Prices Regression 

{
  "data": [
    [8.3252, 41.0, 6.984127, 1.023810, 322.0, 2.555556, 37.88, -122.23],
    [8.3014, 21.0, 6.238137, 0.971880, 2401.0, 2.109842, 37.86, -122.22]
  ]
}

### XGBoost - Iris Classification 

{
  "data": [
    [5.1, 3.5, 1.4, 0.2],
    [4.9, 3.0, 1.4, 0.2]
  ]
}

### PyTorch 

{
  "data": [-1.0568,  1.2518, -0.4604,  1.3156,  0.4191, -0.5685]
}

### TensorFlow 

{
  "data": [
   [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
   ],
   [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
   ],
   [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
   ],
   [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
   ],
   [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
   ],
   [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
   ],
   [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
   ],
   [
      0,
      0,
      0,
      0,
      0,
      0,
      0.32941176,
      0.7254902,
      0.62352941,
      0.59215686,
      0.23529412,
      0.14117647,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
   ],
   [
      0,
      0,
      0,
      0,
      0,
      0,
      0.87058824,
      0.99607843,
      0.99607843,
      0.99607843,
      0.99607843,
      0.94509804,
      0.77647059,
      0.77647059,
      0.77647059,
      0.77647059,
      0.77647059,
      0.77647059,
      0.77647059,
      0.77647059,
      0.66666667,
      0.20392157,
      0,
      0,
      0,
      0,
      0,
      0
   ],
   [
      0,
      0,
      0,
      0,
      0,
      0,
      0.2627451,
      0.44705882,
      0.28235294,
      0.44705882,
      0.63921569,
      0.89019608,
      0.99607843,
      0.88235294,
      0.99607843,
      0.99607843,
      0.99607843,
      0.98039216,
      0.89803922,
      0.99607843,
      0.99607843,
      0.54901961,
      0,
      0,
      0,
      0,
      0,
      0
   ],
   [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0.06666667,
      0.25882353,
      0.05490196,
      0.2627451,
      0.2627451,
      0.2627451,
      0.23137255,
      0.08235294,
      0.9254902,
      0.99607843,
      0.41568627,
      0,
      0,
      0,
      0,
      0,
      0
   ],
   [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0.3254902,
      0.99215686,
      0.81960784,
      0.07058824,
      0,
      0,
      0,
      0,
      0,
      0
   ],
   [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0.08627451,
      0.91372549,
      1,
      0.3254902,
      0,
      0,
      0,
      0,
      0,
      0,
      0
   ],
   [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0.50588235,
      0.99607843,
      0.93333333,
      0.17254902,
      0,
      0,
      0,
      0,
      0,
      0,
      0
   ],
   [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0.23137255,
      0.97647059,
      0.99607843,
      0.24313725,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
   ],
   [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0.52156863,
      0.99607843,
      0.73333333,
      0.01960784,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
   ],
   [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0.03529412,
      0.80392157,
      0.97254902,
      0.22745098,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
   ],
   [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0.49411765,
      0.99607843,
      0.71372549,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
   ],
   [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0.29411765,
      0.98431373,
      0.94117647,
      0.22352941,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
   ],
   [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0.0745098,
      0.86666667,
      0.99607843,
      0.65098039,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
   ],
   [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0.01176471,
      0.79607843,
      0.99607843,
      0.85882353,
      0.1372549,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
   ],
   [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0.14901961,
      0.99607843,
      0.99607843,
      0.30196078,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
   ],
   [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0.12156863,
      0.87843137,
      0.99607843,
      0.45098039,
      0.00392157,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
   ],
   [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0.52156863,
      0.99607843,
      0.99607843,
      0.20392157,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
   ],
   [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0.23921569,
      0.94901961,
      0.99607843,
      0.99607843,
      0.20392157,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
   ],
   [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0.4745098,
      0.99607843,
      0.99607843,
      0.85882353,
      0.15686275,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
   ],
   [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0.4745098,
      0.99607843,
      0.81176471,
      0.07058824,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
   ],
   [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0
   ]
]
}
